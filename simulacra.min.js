/*!
 * Simulacra.js
 * Version 0.0.7
 * https://github.com/0x8890/simulacra
 */
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var processNodes=require("./process_nodes");module.exports=defineProperties;function defineProperties(obj,def){var store={};var properties=Object.keys(obj);var i,j,property;for(i=0,j=properties.length;i<j;i++){property=properties[i];store[property]=obj[property];define(property)}function define(key){var branch=def[key];var mount=branch.mount;var unmount=branch.unmount;var definition=branch.definition;var activeNodes=[];var previousValues=[];Object.defineProperty(obj,key,{get:getter,set:setter,enumerable:true});setter(store[key]);function getter(){return store[key]}function setter(x){var values=Array.isArray(x)?x:[x];var i,j,isEmpty,value,previousValue,node,activeNode,parentNode;store[key]=x;j=Math.max(previousValues.length,values.length);for(i=0;i<j;i++){value=values[i];activeNode=activeNodes[i];previousValue=previousValues[i];isEmpty=value===null||value===void 0;parentNode=branch.marker.parentNode;if(isEmpty){delete previousValues[i];delete activeNodes[i];if(unmount)unmount(activeNode,value,previousValue,i);if(activeNode)parentNode.removeChild(activeNode);continue}if(previousValue===value)continue;previousValues[i]=value;if(unmount)unmount(activeNode,value,previousValue,i);if(activeNode)parentNode.removeChild(activeNode);if(mount){node=branch.node.cloneNode(true);node=mount(node,value,previousValue,i)||node}else if(definition){node=processNodes(branch.node.cloneNode(true),definition);defineProperties(value,definition)}activeNodes[i]=parentNode.insertBefore(node,activeNodes[i+1]||branch.marker)}previousValues.length=activeNodes.length=values.length}}}},{"./process_nodes":4}],2:[function(require,module,exports){"use strict";module.exports=findNodes;function findNodes(node,definition){var treeWalker=document.createTreeWalker(node,NodeFilter.SHOW_ELEMENT);var keys=Object.keys(definition);var map=new WeakMap;var nodes=[];var i,j;for(i=0,j=keys.length;i<j;i++)nodes[nodes.length]=definition[keys[i]].node;while(treeWalker.nextNode()&&j)for(i=0,j=nodes.length;i<j;i++)if(treeWalker.currentNode.isEqualNode(nodes[i])){map.set(nodes[i],treeWalker.currentNode);nodes.splice(i,1)}return map}},{}],3:[function(require,module,exports){"use strict";var processNodes=require("./process_nodes");var defineProperties=require("./define_properties");module.exports=simulacra;function simulacra(a,b,c){if(a instanceof Node)return define(a,b,c);if(typeof a==="object")return bind(a,b);throw new TypeError("First argument must be either "+"an DOM Node or an Object.")}function define(node,def,unmount){var obj={node:node};var seen=new WeakMap;var i,j,keys,value;if(typeof def==="function"){obj.mount=def;if(typeof unmount==="function")obj.unmount=unmount}else if(typeof def==="object"){obj.definition=def;for(i=0,keys=Object.keys(def),j=keys.length;i<j;i++){value=def[keys[i]].node;if(!node.contains(value))throw new Error("The bound DOM Node must be "+"contained in its parent.");if(!seen.get(value))seen.set(value,true);else throw new Error("Can not bind multiple keys to the same "+'DOM Node. Collision found on "'+keys[i]+'".')}}else if(def===void 0){if(node.nodeName==="INPUT"||node.nodeName==="SELECT"){if(node.type==="checkbox"||node.type==="radio")obj.mount=replaceChecked;else obj.mount=replaceValue}else obj.mount=replaceText}else throw new TypeError("Second argument must be either "+"a function or an object.");return obj}function bind(obj,def){var node;if(Array.isArray(obj))throw new TypeError("First argument must be a singular object.");if(!(def.node instanceof Node))throw new TypeError("Top-level binding must have a Node.");if(typeof def.definition!=="object")throw new TypeError("Top-level binding must be an object.");node=processNodes(def.node.cloneNode(true),def.definition);defineProperties(obj,def.definition);return node}function replaceText(node,value){node.textContent=value}function replaceValue(node,value){node.value=value}function replaceChecked(node,value){node.checked=value}},{"./define_properties":1,"./process_nodes":4}],4:[function(require,module,exports){"use strict";var findNodes=require("./find_nodes");module.exports=processNodes;function processNodes(node,def){var keys=Object.keys(def);var map=findNodes(node,def);var i,j,branch,key,mirrorNode,marker,parent;for(i=0,j=keys.length;i<j;i++){key=keys[i];branch=def[key];mirrorNode=map.get(branch.node);parent=mirrorNode.parentNode;marker=document.createTextNode("");branch.marker=parent.insertBefore(marker,mirrorNode);parent.removeChild(mirrorNode)}return node}},{"./find_nodes":2}],5:[function(require,module,exports){"use strict";window.simulacra=require("../lib")},{"../lib":3}]},{},[5]);
